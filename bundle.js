!function(e){var t={};function r(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(i,s,function(t){return e[t]}.bind(null,s));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);var i={isString:e=>"string"==typeof e,isArray:e=>Array.isArray(e),isFunc:e=>"function"==typeof e,is:(e,t)=>typeof e==t};function s(e,t,r,s){if(!i.isString(e))throw new Error("buildElement: nodeName expected to be string");let o=document.createElement(e);if(i.isArray(t))for(const e of t)o.classList.add(e);else i.isString(t)&&(o.className=t);if(r&&i.isFunc(r.appendChild)&&r.appendChild(o),s){s.textContent&&(o.textContent=s.textContent);for(const e in s.attr)o.setAttribute(e,s.attr[e])}return o}function o(e){for(;e.hasChildNodes();)e.removeChild(e.firstChild)}class n{constructor(){this._root=s("div")}willMount(){}willUnmount(){}get rootNode(){return this._root}}var a=new class{constructor(e,t){if(!i.isString(e))throw new Error("WebApi:constructor: hostname expected to be string");if(!i.isString(t))throw new Error("WebApi:constructor: apikey expected to be string");this._host=e,this._key=t}get hostname(){return this._host}get apiKey(){return this._key}async getResource(e,t){if(!i.isString(e))throw new Error("WebApi:getResource: endpoint expected to be string");"/"!=e.charAt(0)&&(e=`/${e}`),e+=`?api_key=${this.apiKey}`;for(const r in t)e+=`&${r}=${t[r]}`;const r=`${this.hostname}${e}`,s=new Request(r),o=new Headers;let n,a;try{n=await fetch(s,{headers:o,method:"GET",mode:"cors"})}catch(e){let t=`WebApi:getResource: network error while fetching ${r}`;if(e&&e.message)throw new Error(`${t}: ${e.message}`);throw new Error(t)}try{a=await n.json()}catch(e){}if(!n.ok){let e=`WebApi:getResource: abnormal status code ${n.status} for ${r}`;throw a&&a.status_message&&(e+=`: ${a.status_message}`),new Error(e)}return a}}("https://api.themoviedb.org/3","b5880e972dee461bfc30e6155e7fb62f");class h{constructor(e){if(this._movieID=e.id,this._root=s("div",["movie-card-container","blur-focus-in"]),this._headerNode=s("div","movie-card-header",this._root),this._yearNode=s("div","movie-card-year",this._headerNode,{textContent:e.year+""}),this._titleNode=s("h1","movie-card-title",this._headerNode,{textContent:e.title}),this._vote_averageNode=s("div","movie-card-vote-average",this._headerNode,{textContent:e.vote_average+""}),this._contentWrapperNode=s("div","movie-card-content-wrapper",this._root),e.poster_path&&(this._posterNode=s("img","movie-card-poster",this._contentWrapperNode),"/"!=e.poster_path.charAt(0)&&(e.poster_path=`/${e.poster_path}`),fetch(`https://image.tmdb.org/t/p/w200${e.poster_path}`).then(e=>e.blob()).then(e=>{this._posterImg=URL.createObjectURL(e),this._posterNode.setAttribute("src",this._posterImg),this._posterNode.addEventListener("load",()=>{URL.revokeObjectURL(this._posterImg)})})),e.overview&&(this._overviewNode=s("p","movie-card-overview",this._contentWrapperNode,{textContent:e.overview})),this._expandedWrapper=s("div",["movie-card-expanded-wrapper","invisible"],this._contentWrapperNode),this._reviewsWrapperNode=s("div","movie-card-expanded-reviews",this._expandedWrapper),this._similarWrapperNode=s("div","movie-card-expanded-similar",this._expandedWrapper),e.genres&&e.genres.length){this._genreWrapperNode=s("div","movie-card-genre-wrapper",this._root),this._genreNodes=[];for(const t of e.genres)this._genreNodes.push(s("span","movie-card-genre",this._genreWrapperNode,{textContent:t}))}this._isExpanded=!1,this._onClick=this._onClick.bind(this),this._root.addEventListener("click",this._onClick)}insertOnParent(e){i.isFunc(e.insertAdjacentElement)?e.insertAdjacentElement("afterbegin",this._root):console.warn("MovieCard:insertOnParent: parent argument expected to be DOM element")}appendOnParent(e){i.isFunc(e.insertAdjacentElement)?e.insertAdjacentElement("beforeend",this._root):console.warn("MovieCard:appendOnParent: parent argument expected to be DOM element")}async _expandCard(){if(this._expandedWrapper.classList.remove("invisible"),this._isExpanded=!0,!this._videoNode){const e=await a.getResource(`/movie/${this._movieID}/videos`);e.results&&e.results.length>0&&e.results[0].key&&(this._videoNode=s("iframe","movie-card-expanded-video",this._expandedWrapper,{attr:{src:`https://www.youtube.com/embed/${e.results[0].key}`,frameborder:0,allowfullscreen:!0}}))}if(!this._similarListNode){const e=await a.getResource(`/movie/${this._movieID}/similar`);if(e.total_results>0){this._similarHeaderNode=s("h3","movie-card-expanded-similar-header",this._similarWrapperNode,{textContent:"Similar movies:"}),this._similarListNode=s("ul","movie-card-expanded-similar-list",this._similarWrapperNode);for(const t of e.results){let e="";t.release_date&&(e=` (${new Date(t.release_date).getFullYear()})`),s("li","movie-card-expanded-similar-list-item",this._similarListNode,{textContent:`${t.title}${e}`})}}}if(!this._reviewsListNode){const e=await a.getResource(`/movie/${this._movieID}/reviews`);if(e.total_results>0){this._reviewsHeaderNode=s("h3","movie-card-expanded-reviews-header",this._reviewsWrapperNode,{textContent:"Reviews:"}),this._reviewsListNode=s("ul","movie-card-expanded-reviews-list",this._reviewsWrapperNode);for(const t of e.results){let e=s("li","movie-card-expanded-reviews-list-item",this._reviewsListNode);s("h4","movie-card-expanded-reviews-list-item-header",e,{textContent:t.author}),s("p","movie-card-expanded-reviews-list-item-content",e,{textContent:t.content})}}}this._root.scrollIntoView({behavior:"smooth"})}async _minifyCard(){this._expandedWrapper.classList.add("invisible"),this._isExpanded=!1;const e=this._root.parentNode;e.scrollTop--,e.scrollTop++}_onClick(){this._isExpanded?this._minifyCard():this._expandCard()}}var d={_genres:{},_initialized:!1,async init(){if(this._initialized)return;this._initialized=!0;const e=(await a.getResource("/genre/movie/list")).genres;if(void 0!==e)for(const t of e)this._genres[t.id]=t.name},get(e){const t=this._genres[e];return void 0===t?e+"":t}};class l{constructor(e){this._root=e,this._onScroll=this._onScroll.bind(this)}setDataSource(e,t){this._root.removeEventListener("scroll",this._onScroll),this._endpoint=e,this._param=t,this._currentPage=0,this._root.addEventListener("scroll",this._onScroll),this._renderNextPage()}async _renderNextPage(){this._currentPage++;let e=await a.getResource(this._endpoint,{page:this._currentPage,...this._param});for(const t of e.results){let e,r=[];for(const e of t.genre_ids)r.push(d.get(e));e=""==t.release_date?"":new Date(t.release_date).getFullYear(),new h({id:t.id,title:t.title,poster_path:t.poster_path,vote_average:t.vote_average,overview:t.overview,genres:r,year:e}).appendOnParent(this._root)}this._currentPage<e.total_pages&&this._root.addEventListener("scroll",this._onScroll)}_onScroll(e){const t=e.target;t.scrollTop+t.offsetHeight>=t.scrollHeight-80&&(this._root.removeEventListener("scroll",this._onScroll),this._renderNextPage())}}class c extends n{constructor(){super(),this.rootNode.classList.add("wrap-row-container"),this._movielist=new l(this.rootNode)}willMount(){this._movielist.setDataSource("/movie/now_playing")}willUnmount(){o(this.rootNode)}}class p extends n{constructor(){super(),this.rootNode.classList.add("search-page"),this._searchbarWrapper=s("div","search-bar-wrapper",this.rootNode),this._searchbar=s("input",["search-bar","slide-in-left"],this._searchbarWrapper,{attr:{type:"text",placeholder:"Search movies..."}}),this._lastquery="",this._movielistWrapper=s("div","wrap-row-container",this.rootNode),this._onSearchBarInput=this._onSearchBarInput.bind(this),this._movielist=new l(this._movielistWrapper)}_onSearchBarInput(){this._lastquery!=this._searchbar.value&&(this._lastquery=this._searchbar.value,this._queryMovies())}_queryMovies(){o(this._movielistWrapper),""!=this._lastquery&&this._movielist.setDataSource("/search/movie",{query:this._lastquery})}willMount(){this._queryMovies(),this._intervalID=setInterval(this._onSearchBarInput,1e3)}willUnmount(){o(this._movielistWrapper),this._lastquery=this._searchbar.value,clearInterval(this._intervalID)}}class _{constructor(e,t){if(!i.isArray(e))throw new Error("NavBar:constructor: pages expected to be array");this._navNode=s("nav",null,t),this._logoNode=s("div",["header-logo","blur-focus-in"],this._navNode),this._listNode=s("ul",null,this._navNode);for(const t of e){let e=s("li",null,this._listNode);s("a","blur-focus-in",e,{attr:{href:t.hash},textContent:t.name})}}get rootNode(){return this._navNode}}class u{constructor(e,t,r){if(!i.isArray(e))throw new Error("AppRouter:constructor: pages expected to be array");if(!i.isString(t))throw new Error("AppRouter:constructor: pageTitle expected to be string");this._pages=e,this._title=t,this._root=r,this._index=e[0],this._onHashChange=this._onHashChange.bind(this),window.addEventListener("hashchange",this._onHashChange)}setPageFromURL(e){let t=!1;if(e||(e=window.location.hash),""!=e)for(const r of this._pages)if(e==r.hash){t=!0,this._setPage(r);break}t||(this._setPage(this._index),window.removeEventListener("hashchange",this._onHashChange),window.location.hash=this._index.hash,window.addEventListener("hashchange",this._onHashChange))}_setPage(e){e.element.willMount(this._root),document.title=`${this._title} - ${e.name}`,this._currentElement?(this._currentElement.willUnmount(),this._root.replaceChild(e.element.rootNode,this._root.firstChild)):this._root.appendChild(e.element.rootNode),this._currentElement=e.element}_onHashChange(){this.setPageFromURL()}}!function(){const e=[{name:"In Theaters",hash:"#intheaters",element:new c},{name:"Search",hash:"#search",element:new p}],t=function(e){const t=s("header","header-container");return new _(e,t),t}(e),r=s("main","main-container"),i=s("footer","footer-container");document.body.insertAdjacentElement("afterbegin",t),t.insertAdjacentElement("afterend",r),r.insertAdjacentElement("afterend",i),d.init().then(()=>{new u(e,"MovieRama",r).setPageFromURL()})}()}]);